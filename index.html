<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pirimid | Revolutionizing Construction Productivity</title>
    <!-- Chosen Palette: Corporate Blue & Neutrals -->
    <!-- Application Structure Plan: A narrative, single-page scrolling application that guides the user from the high-level business case to a tangible, interactive product demonstration. The structure is thematic: Hero, The Big Picture (Problem/Market/Opportunity), The Solution (Product), Interactive Demo, and Competition. This flow is designed to first convince the user of the "why" (the business case) and then let them experience the "how" (the product's value) through direct interaction. The interactive demo with sliders directly showcases the "Scenario Analysis" feature, making the core value proposition tangible and more impactful than a static image. -->
    <!-- Visualization & Content Choices: The core of the application is the interactive demo. Report Info: Forecasting example. Goal: Compare, Change, Relate. Viz/Method: A Chart.js line chart to show multiple forecasts, HTML/Tailwind metric cards for key stats, and HTML range sliders for user input. Interaction: User manipulates sliders for operational variables (e.g., Equipment Hours). JS listeners recalculate a "Mitigated Forecast" and update both the chart and metric cards in real-time. Justification: This transforms the static PDF example into a dynamic "what-if" tool, directly demonstrating Pirimid's value in a memorable way. Other report data (market size, problem stats) are presented as clear, static "stat cards" for quick comprehension. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
            color: #1e293b; /* slate-800 */
        }
        .section-title {
            font-size: 2.25rem;
            font-weight: 800;
            line-height: 1.2;
            color: #0f172a; /* slate-900 */
        }
        .section-subtitle {
            font-size: 1.125rem;
            color: #475569; /* slate-600 */
            max-width: 60ch;
            margin: 1rem auto 0;
        }
        .stat-card {
            background-color: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            border: 1px solid #e2e8f0; /* slate-200 */
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -2px rgb(0 0 0 / 0.1);
        }
        .stat-value {
            font-size: 3rem;
            font-weight: 800;
            color: #0ea5e9; /* sky-500 */
        }
        .stat-label {
            font-size: 1rem;
            font-weight: 500;
            color: #475569; /* slate-600 */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 900px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
                max-height: 500px;
            }
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #0ea5e9; /* sky-500 */
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 0 5px rgba(14, 165, 233, 0.5);
        }
        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #0ea5e9; /* sky-500 */
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 0 5px rgba(14, 165, 233, 0.5);
        }
        .loading-spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #0ea5e9;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="antialiased">

    <!-- Header -->
    <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 border-b border-slate-200">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <span class="text-2xl font-bold text-slate-800">Pirimid</span>
                </div>
                <div class="hidden md:flex items-center space-x-8">
                    <a href="#overview" class="text-slate-600 hover:text-sky-500 transition-colors">Overview</a>
                    <a href="#solution" class="text-slate-600 hover:text-sky-500 transition-colors">Solution</a>
                    <a href="#demo" class="text-slate-600 hover:text-sky-500 transition-colors">Interactive Demo</a>
                </div>
                <a href="#demo" class="hidden md:block bg-sky-500 text-white px-4 py-2 rounded-lg font-semibold hover:bg-sky-600 transition-colors">See It In Action</a>
            </div>
        </nav>
    </header>

    <!-- Hero Section -->
    <main>
        <section class="py-20 md:py-32 text-center bg-white">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <h1 class="text-4xl md:text-6xl font-extrabold text-slate-900 leading-tight">
                    Building the Future of Construction <span class="text-sky-500">Intelligence</span>.
                </h1>
                <p class="mt-6 max-w-2xl mx-auto text-lg text-slate-600">
                    Pirimid provides a continuous real-time data twin of construction operations, turning complex project data into clear, actionable insights to compress schedule and improve predictability.
                </p>
                <div class="mt-8">
                    <a href="#demo" class="bg-sky-500 text-white px-8 py-3 rounded-lg font-bold text-lg hover:bg-sky-600 transition-transform hover:scale-105 inline-block">Explore the Demo</a>
                </div>
            </div>
        </section>

        <!-- The Big Picture Section -->
        <section id="overview" class="py-16 md:py-24">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h2 class="section-title">An Industry Ready for Disruption</h2>
                <p class="section-subtitle">Construction has struggled with productivity for decades. The market is massive, and the cost of inefficiency is staggering.</p>
                <div class="mt-12 grid gap-8 md:grid-cols-3">
                    <div class="stat-card text-center">
                        <div class="stat-value text-red-500">62%</div>
                        <div class="stat-label mt-2">Average Mega-Project Overrun</div>
                        <p class="text-sm text-slate-500 mt-2">Legacy systems fail to explain why projects fall behind, creating massive risk.</p>
                    </div>
                    <div class="stat-card text-center">
                        <div class="stat-value">$1.2T</div>
                        <div class="stat-label mt-2">US Non-Residential Market</div>
                        <p class="text-sm text-slate-500 mt-2">Part of a $10T+ global industry, representing a vast landscape for efficiency gains.</p>
                    </div>
                    <div class="stat-card text-center">
                        <div class="stat-value">5-40%</div>
                        <div class="stat-label mt-2">Potential Cost & Duration Reduction</div>
                        <p class="text-sm text-slate-500 mt-2">Applying manufacturing operations science principles can unlock huge savings, and Pirimid enables this.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- The Solution Section -->
        <section id="solution" class="py-16 md:py-24 bg-white">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center">
                    <h2 class="section-title">The Pirimid Platform</h2>
                    <p class="section-subtitle">We close the loop between plan and reality with powerful data twins.</p>
                </div>
                <div class="mt-12 grid md:grid-cols-2 gap-12 items-center">
                    <div class="prose lg:prose-lg text-slate-600">
                        <p><strong>Real-Time Digital Twin</strong></p>
                        <p>Pirimid creates a live, data-rich model of your construction site's operations. We track critical processes, such as welding or prefabrication, and compare progress against your plan in real-time, not weeks later.</p>
                         <p><strong>AI-Powered Insights</strong></p>
                        <p>Our platform doesn't just show you data; it interprets it. AI-enabled alerts automatically notify you when an operation is blocked or trending off-track and suggest potential mitigations before a small issue becomes a major delay.</p>
                        <p><strong>Why Now?</strong></p>
                        <p>The convergence of increasingly connected equipment and powerful AI capabilities has created the perfect moment. The same technological shift transformed manufacturing 15 years ago, creating billion-dollar companies. Construction is next.</p>
                    </div>
                     <div class="bg-slate-100 p-8 rounded-lg border border-slate-200">
                        <h4 class="text-xl font-bold text-slate-800 mb-4">Core Features</h4>
                        <ul class="space-y-4">
                            <li class="flex items-start">
                                <span class="text-sky-500 mr-3 mt-1">&#10004;</span>
                                <div><strong class="text-slate-700">Live Progress Tracking:</strong> Compare performance against plan continuously. AI identifies potential delays before they happen.</div>
                            </li>
                            <li class="flex items-start">
                                <span class="text-sky-500 mr-3 mt-1">&#10004;</span>
                                <div><strong class="text-slate-700">Automated Benchmarking:</strong> Assess performance relative to internal and external projects in real-time.</div>
                            </li>
                            <li class="flex items-start">
                                <span class="text-sky-500 mr-3 mt-1">&#10004;</span>
                                <div><strong class="text-slate-700">Root Cause Analysis:</strong> Use continuous data to separate execution from blockers to understand the "why" behind variances.</div>
                            </li>
                            <li class="flex items-start">
                                <span class="text-sky-500 mr-3 mt-1">&#10004;</span>
                                <div><strong class="text-slate-700">Predictive Forecasting:</strong> See the future impact of today's performance.</div>
                            </li>
                            <li class="flex items-start">
                                <span class="text-sky-500 mr-3 mt-1">&#10004;</span>
                                <div><strong class="text-slate-700">Interactive Scenario Planning:</strong> Model the effect of mitigations to find the best path forward.</div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Interactive Demo Section -->
        <section id="demo" class="py-16 md:py-24">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center">
                    <h2 class="section-title">Experience the Pirimid Advantage</h2>
                    <p class="section-subtitle">This is more than a report; it's a command center. The interactive dashboard below simulates how a project manager uses Pirimid to analyze an curtain wall installation. Adjust the operational levers to see how you can proactively steer your project back on track.</p>
                </div>

                <div class="mt-12 bg-white p-6 md:p-8 rounded-xl shadow-2xl border border-slate-200">
                    <div class="chart-container mb-8">
                        <canvas id="progressChart"></canvas>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8">
                        <!-- Controls -->
                        <div class="md:col-span-2 bg-slate-50 p-6 rounded-lg border border-slate-200">
                            <h4 class="text-lg font-bold text-slate-800 mb-4">Scenario Controls</h4>
                            <div class="space-y-6">
                                <div>
                                    <label for="equipmentHours" class="block font-medium text-slate-700">Working Time (hrs/day)</label>
                                    <div class="flex items-center space-x-4">
                                        <input type="range" id="equipmentHours" min="7" max="11" step="0.25" value="9" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
                                        <span id="equipmentHoursValue" class="font-bold text-sky-600 w-16 text-center text-lg">6.10</span>
                                    </div>
                                </div>
                                <div>
                                    <label for="removalRates" class="block font-medium text-slate-700">Average Wait (min/day)</label>
                                     <div class="flex items-center space-x-4">
                                        <input type="range" id="removalRates" min="0" max="60" step="0.01" value="30" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
                                        <span id="removalRatesValue" class="font-bold text-sky-600 w-16 text-center text-lg">1.63</span>
                                    </div>
                                </div>
                                <div>
                                    <label for="panelInstallTime" class="block font-medium text-slate-700">Panel Install Time (min/panel)</label>
                                     <div class="flex items-center space-x-4">
                                        <input type="range" id="panelInstallTime" min="35" max="65" step="1" value="50" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
                                        <span id="panelInstallTimeValue" class="font-bold text-sky-600 w-16 text-center text-lg">50</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Key Metric -->
                        <div class="bg-slate-800 text-white p-6 rounded-lg flex flex-col items-center justify-center">
                            <div class="text-slate-300 text-lg font-medium">Projected End Date Variance</div>
                            <div id="endDateVariance" class="text-5xl font-extrabold mt-2 text-amber-400">-15 Days</div>
                            <div class="text-slate-400 mt-2">from Plan</div>
                            <button id="getMitigationBtn" class="mt-6 bg-sky-500 text-white px-6 py-2 rounded-lg font-semibold hover:bg-sky-600 transition-colors flex items-center justify-center">
                                Get AI Mitigation Suggestions ✨
                            </button>
                        </div>
                    </div>
                    <div id="mitigationSuggestions" class="mt-8 bg-sky-50 p-6 rounded-lg border border-sky-200 hidden">
                        <h4 class="text-lg font-bold text-sky-800 mb-4">AI Mitigation Suggestions</h4>
                        <div id="suggestionContent" class="text-slate-700"></div>
                        <div id="suggestionLoading" class="hidden flex items-center justify-center py-4">
                            <div class="loading-spinner"></div>
                            <span class="ml-3 text-sky-700">Generating suggestions...</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Competition Section -->
        <section class="py-16 md:py-24 bg-white">
            <div class="container mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <h2 class="section-title">A Clear Competitive Edge</h2>
                <p class="section-subtitle">While other solutions exist, they often provide an incomplete picture. Pirimid is built to deliver not just data, but frequent, actionable intelligence that directly links to project outcomes.</p>
                <div class="mt-12 max-w-4xl mx-auto prose lg:prose-lg text-slate-600 text-left">
                    <p>The primary competition comes from computer vision companies. These platforms are excellent at measuring what has been built. However, they often leave gaps in two critical areas:</p>
                    <ul>
                        <li><strong>Frequency:</strong> Data capture can be periodic, missing the day-to-day operational blockers and conflicts that lead to deviations. Pirimid's digital twin is designed for higher frequency data streams.</li>
                        <li><strong>Actionable Insights:</strong> A photo or a 3D model shows progress, but it doesn't always provide sufficient context to explain a delay or model the impact of a potential solution. Pirimid links operational data with project documentation to decompose effects and highlight blockers enabling true cause-and-effect analysis and proactive planning.</li>
                    </ul>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-slate-800 text-slate-400">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 text-center">
            <p>&copy; 2025 Pirimid. All rights reserved.</p>
            <p class="text-sm mt-2">Modernizing construction, one data point at a time.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const ctx = document.getElementById('progressChart').getContext('2d');

            const initialData = {
                labels: ['2025-03-02', '2025-03-03', '2025-03-04', '2025-03-05','2025-03-06', '2025-03-07', '2025-03-08', '2025-03-09','2025-03-10', '2025-03-11', '2025-03-12', '2025-03-13','2025-03-14', '2025-03-15', '2025-03-16', '2025-03-17','2025-03-18', '2025-03-19', '2025-03-20', '2025-03-21','2025-03-22', '2025-03-23', '2025-03-24', '2025-03-25','2025-03-26', '2025-03-27', '2025-03-28', '2025-03-29','2025-03-30', '2025-03-31', '2025-04-01', '2025-04-02','2025-04-03', '2025-04-04', '2025-04-05', '2025-04-06','2025-04-07', '2025-04-08', '2025-04-09', '2025-04-10','2025-04-11', '2025-04-12', '2025-04-13', '2025-04-14','2025-04-15', '2025-04-16', '2025-04-17', '2025-04-18','2025-04-19', '2025-04-20', '2025-04-21', '2025-04-22','2025-04-23', '2025-04-24', '2025-04-25', '2025-04-26','2025-04-27', '2025-04-28', '2025-04-29', '2025-04-30','2025-05-01', '2025-05-02', '2025-05-03', '2025-05-04','2025-05-05', '2025-05-06', '2025-05-07', '2025-05-08','2025-05-09', '2025-05-10', '2025-05-11', '2025-05-12','2025-05-13', '2025-05-14', '2025-05-15', '2025-05-16','2025-05-17', '2025-05-18', '2025-05-19', '2025-05-20','2025-05-21', '2025-05-22', '2025-05-23', '2025-05-24','2025-05-25', '2025-05-26', '2025-05-27', '2025-05-28','2025-05-29', '2025-05-30', '2025-05-31', '2025-06-01','2025-06-02', '2025-06-03', '2025-06-04', '2025-06-05','2025-06-06', '2025-06-07', '2025-06-08'],
                planned: [10,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320,330,340,350,360,370,380,390,400,410,420,430,440,450,460,470,480,490,500,510,520,530,540,550,560,570,580,590,600,610,620,630,640,650,660,670,680,690,700,710,720,730,740,750,760,770,780,790,800,810,820,830,840,850,860,870,880,890,900,910,920,930,940,950,960,970,980,990,1000],
                actual: [12,26,38,50,60,64,69,82,88,96,103,109,117,123,135,145,155,163,171,176,187,201,207,218,223,229,233,243,257,268,280,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],
                baseForecast: [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,280,290,300,310,320,330,340,350,360,370,380,390,400,410,420,430,440,450,460,470,480,490,500,510,520,530,540,550,560,570,580,590,600,610,620,630,640,650,660,670,680,690,700,710,720,730,740,750,760,770,780,790,800,810,820,830,840,850,860,870,880,890,900,910,920,930,940,950,960,970]

            };
            
            const equipmentHoursSlider = document.getElementById('equipmentHours');
            const removalRatesSlider = document.getElementById('removalRates');
            const panelInstallTimeSlider = document.getElementById('panelInstallTime'); // New slider
            const panelInstallTimeValue = document.getElementById('panelInstallTimeValue'); // New value display
            const equipmentHoursValue = document.getElementById('equipmentHoursValue');
            const removalRatesValue = document.getElementById('removalRatesValue');
            const endDateVarianceEl = document.getElementById('endDateVariance');
            const getMitigationBtn = document.getElementById('getMitigationBtn');
            const mitigationSuggestionsDiv = document.getElementById('mitigationSuggestions');
            const suggestionContent = document.getElementById('suggestionContent');
            const suggestionLoading = document.getElementById('suggestionLoading');


            let chart;

            function calculateMitigatedForecast(baseForecast, equipmentHours, removalRates, panelInstallTime) {
                const actualEndIndex = initialData.actual.findLastIndex(v => v !== null);
                const planHours = 9;
                const planRate = 1;
                
                const hoursFactor = equipmentHours / planHours;
                const rateFactor = removalRates / planRate;
                const overallFactor = (50/panelInstallTime*(equipmentHours - removalRates /60)/10);

                let mitigated = [...baseForecast];
                let lastActualValue = initialData.actual[actualEndIndex];

                for (let i = actualEndIndex + 1; i < mitigated.length; i++) {
                    const baseIncrement = baseForecast[i] - baseForecast[i-1];
                    const mitigatedIncrement = baseIncrement * overallFactor;
                    lastActualValue += mitigatedIncrement;
                    mitigated[i] = lastActualValue;
                }
                return mitigated;
            }
            
            function calculateEndDateVariance(mitigatedForecast) {
                const target = 1000;
                const planDays = 100;
                
                const lastForecastValue = mitigatedForecast[mitigatedForecast.length - 1];
                if (lastForecastValue >= target) {
                    return 0; 
                }
                
                const dailyRate = (mitigatedForecast[mitigatedForecast.length-1] - mitigatedForecast[mitigatedForecast.length-2]) ;
                const remainingWork = target - lastForecastValue;
                const daysNeeded = remainingWork / dailyRate;
                
                const planDailyRate = (initialData.planned[initialData.planned.length-1] - initialData.planned[initialData.planned.length-2]) ;
                const planDaysNeeded = (target - initialData.planned[initialData.planned.length-1]) / planDailyRate;


                const totalProjectedDays = (initialData.labels.length-1)  + daysNeeded;
                const variance = planDays - totalProjectedDays;
                
                return Math.round(variance);
            }


            function updateUI() {
                const equipmentHours = parseFloat(equipmentHoursSlider.value);
                const removalRates = parseFloat(removalRatesSlider.value);
                const panelInstallTime = parseFloat(panelInstallTimeSlider.value);

                equipmentHoursValue.textContent = equipmentHours.toFixed(1);
                removalRatesValue.textContent = removalRates.toFixed(1);
                panelInstallTimeValue.textContent = panelInstallTime.toFixed(1); // Display as integer



                const mitigatedForecast = calculateMitigatedForecast(initialData.baseForecast, equipmentHours, removalRates, panelInstallTime);
                chart.data.datasets[3].data = mitigatedForecast;
                chart.update();
                
                const variance = calculateEndDateVariance(mitigatedForecast);
                endDateVarianceEl.textContent = `${variance > 0 ? '+' : ''}${variance} Days`;
                if (variance < -10) {
                    endDateVarianceEl.classList.remove('text-amber-400', 'text-green-400');
                    endDateVarianceEl.classList.add('text-red-400');
                } else if (variance < 0) {
                    endDateVarianceEl.classList.remove('text-red-400', 'text-green-400');
                    endDateVarianceEl.classList.add('text-amber-400');
                } else {
                    endDateVarianceEl.classList.remove('text-red-400', 'text-amber-400');
                    endDateVarianceEl.classList.add('text-green-400');
                }

            }

            const data = {
                labels: initialData.labels,
                datasets: [{
                    label: 'Planned',
                    data: initialData.planned,
                    borderColor: '#3b82f6', // blue-500
                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                    borderWidth: 3,
                    pointRadius: 0,
                    tension: 0.1,
                    fill: false,
                }, {
                    label: 'Actual',
                    data: initialData.actual,
                    borderColor: '#ef4444', // red-500
                    backgroundColor: 'rgba(239, 68, 68, 0.1)',
                    borderWidth: 2,
                    pointRadius: 2,
                    tension: 0.1,
                    fill: false,
                }, {
                    label: 'Default Forecast',
                    data: initialData.baseForecast,
                    borderColor: '#f59e0b', // amber-500
                    backgroundColor: 'rgba(245, 158, 11, 0.1)',
                    borderWidth: 2,
                    borderDash: [5, 5],
                    pointRadius: 0,
                    tension: 0.1,
                    fill: false,
                }, {
                    label: 'Pirimid Forecast',
                    data: [],
                    borderColor: '#22c55e', // green-500
                    backgroundColor: 'rgba(34, 197, 94, 0.1)',
                    borderWidth: 3,
                    borderDash: [5, 5],
                    pointRadius: 0,
                    tension: 0.1,
                    fill: false,
                }]
            };

            const config = {
                type: 'line',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                pointStyle: 'rectRounded'
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: '#0f172a', // slate-900
                            titleFont: { weight: 'bold' },
                            bodySpacing: 4,
                            padding: 12,
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += context.parsed.y.toFixed(0) + ' Panels';
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: '#64748b' // slate-500
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Panels Installed',
                                color: '#334155', // slate-700
                                font: {
                                    weight: 'bold'
                                }
                            },
                            beginAtZero: true,
                            max: 1000,
                            grid: {
                                color: '#e2e8f0' // slate-200
                            },
                            ticks: {
                                color: '#64748b' // slate-500
                            }
                        }
                    },
                    interaction: {
                        mode: 'index',
                        intersect: false
                    }
                }
            };

            chart = new Chart(ctx, config);
            
            equipmentHoursSlider.addEventListener('input', updateUI);
            removalRatesSlider.addEventListener('input', updateUI);
            panelInstallTimeSlider.addEventListener('input', updateUI); // Event listener for new slider


            updateUI();

            getMitigationBtn.addEventListener('click', async () => {
                const varianceText = endDateVarianceEl.textContent;
                const prompt = `The construction project is currently projected to be ${varianceText.replace('+', '').trim()} schedule. Given this variance, suggest 3 concise, actionable mitigation strategies for a construction project manager. Format as a bulleted list.`;

                mitigationSuggestionsDiv.classList.remove('hidden');
                suggestionContent.innerHTML = '';
                suggestionLoading.classList.remove('hidden');
                getMitigationBtn.disabled = true;

                let retries = 0;
                const maxRetries = 5;
                const baseDelay = 1000; // 1 second

                while (retries < maxRetries) {
                    try {
                        let chatHistory = [];
                        chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                        const payload = { contents: chatHistory };
                        const apiKey = "";
                        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (response.status === 429) { // Too Many Requests
                            const delay = baseDelay * Math.pow(2, retries) + Math.random() * 1000;
                            console.warn(`Rate limit hit. Retrying in ${delay / 1000} seconds...`);
                            await new Promise(res => setTimeout(res, delay));
                            retries++;
                            continue;
                        }

                        const result = await response.json();

                        if (result.candidates && result.candidates.length > 0 &&
                            result.candidates[0].content && result.candidates[0].content.parts &&
                            result.candidates[0].content.parts.length > 0) {
                            const text = result.candidates[0].content.parts[0].text;
                            suggestionContent.innerHTML = text.replace(/\*/g, '').split('\n').filter(line => line.trim() !== '').map(line => `<li>${line.trim()}</li>`).join('');
                        } else {
                            suggestionContent.innerHTML = '<p class="text-blue-500">Working Time and Panel Install Time are meeting plan. Multiple delays of waiting for material of up to 4 hours have put project behind by ~10%.</p>';
                        }
                        break; // Exit loop on success
                    } catch (error) {
                        console.error('Error fetching suggestions:', error);
                        suggestionContent.innerHTML = '<p class="text-red-500">An error occurred. Please try again.</p>';
                        break; // Exit loop on fatal error
                    } finally {
                        suggestionLoading.classList.add('hidden');
                        getMitigationBtn.disabled = false;
                    }
                }
                if (retries === maxRetries) {
                    suggestionContent.innerHTML = '<p class="text-red-500">Failed to get suggestions after multiple retries. Please try again later.</p>';
                    suggestionLoading.classList.add('hidden');
                    getMitigationBtn.disabled = false;
                }
            });
        });
    </script>
</body>
</html>
